<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Find the right SF Tech Week events</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; background: #0b0c10; color: #fff; }
      .wrap { max-width: 820px; margin: 0 auto; padding: 24px; }
      .card { background: #12141a; border: 1px solid #222631; border-radius: 12px; padding: 16px; }
      h1 { font-size: 20px; margin: 0 0 12px; }
      textarea { width: 100%; min-height: 120px; border-radius: 8px; border: 1px solid #303645; background: #0e1016; color: #fff; padding: 12px; resize: vertical; }
      button { background: #5b8cff; color: #fff; border: none; padding: 10px 14px; border-radius: 8px; cursor: pointer; }
      button[disabled] { opacity: 0.6; cursor: default; }
      .row { display: flex; gap: 8px; align-items: center; margin-top: 10px; }
      .results { margin-top: 18px; }
      .event { padding: 12px; border-bottom: 1px solid #222631; }
      .event:last-child { border-bottom: 0; }
      .event a { color: #8ab4ff; text-decoration: none; }
      .small { color: #a8b3cf; font-size: 13px; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card">
        <h1>Tell us about you and your goals</h1>
        <p class="small">What do you build? What do you want from SF Tech Week (e.g., meet AI infra investors, find early adopters in healthcare, recruit design talent, only evenings)?</p>
        <textarea id="input" placeholder="I’m Durva and I am building an AI agent platform for sales teams. I want to meet B2B SaaS founders and angels, and attend evening events near SoMa. Prefer free or <$30."></textarea>
        <div class="row">
          <button id="go">Find the right events</button>
          <span id="status" class="small"></span>
        </div>
      </div>

      <div id="out" class="card results" hidden>
        <div class="small mono" id="prefs"></div>
        <div id="events"></div>
      </div>
    </div>

    <script>
      const $ = (id) => document.getElementById(id);
      const btn = $('go');
      const input = $('input');
      const status = $('status');
      const out = $('out');
      const prefsEl = $('prefs');
      const eventsEl = $('events');

      async function recommend() {
        const message = input.value.trim();
        if (!message) return;
        btn.disabled = true; status.textContent = 'Thinking…';
        out.hidden = true; eventsEl.innerHTML = ''; prefsEl.textContent = '';
        try {
          const resp = await fetch('/api/recommend-events', {
            method: 'POST', headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message, limit: 10 })
          });
          const data = await resp.json();
          if (!data.ok) throw new Error(data.error || 'Failed');
          prefsEl.textContent = 'Parsed preferences: ' + JSON.stringify(data.prefs);
          eventsEl.innerHTML = data.results.map(r => `
            <div class="event">
              <div><strong>${r.name}</strong></div>
              <div class="small">${r.date || ''} ${r.time || ''} — ${r.location || 'TBA'} — ${r.price || ''}</div>
              <div class="small">Host: ${r.host || '—'}</div>
              <div><a href="${r.url}" target="_blank" rel="noopener">View details ↗</a></div>
            </div>
          `).join('');
          out.hidden = false;
        } catch (e) {
          alert(e.message);
        } finally {
          btn.disabled = false; status.textContent = '';
        }
      }

      btn.addEventListener('click', recommend);
      input.addEventListener('keydown', (e) => { if (e.key === 'Enter' && (e.metaKey || e.ctrlKey)) recommend(); });
    </script>
  </body>
  </html>

